/*
 * Copyright (c) 2025 ArqAlice
 *
 * Released under the MIT license
 * https://opensource.org/licenses/mit-license.php
 */

#include <stdlib.h>
#include "pico/stdlib.h"

// BQ-IIR 2x filter0  44.1k/48k to 88.2k/96k
const float coef_bq_filter_2x_0[17][6] =
    {{0.0002343756245407308, 0.00046261038494493294, 0.00023437562454073092, 1.0, 0.34383476467956303, 0.0},
     {1.0, 1.89812104364948, 1.0000000000000002, 1.0, 0.6810483393061059, 0.12307481835318078},
     {1.0, 1.7810055695841391, 0.9999999999999999, 1.0, 0.6615356761302918, 0.1374624529582442},
     {1.0, 1.6337297170025797, 1.0000000000000002, 1.0, 0.6301472851776473, 0.16089674437346455},
     {1.0, 1.4685524707857411, 0.9999999999999999, 1.0, 0.5884603800255389, 0.192628943418042},
     {1.0, 1.0, 0.0, 1.0, 0.5384641893414541, 0.23173524542426227},
     {1.0, 1.296822578668515, 1.0, 1.0, 0.48239145693743424, 0.2772142190102482},
     {1.0, 1.1278393438001153, 1.0, 1.0, 0.42255747906659463, 0.32808236950839226},
     {1.0, 0.9684697923667892, 1.0000000000000002, 1.0, 0.36122710766115024, 0.3834572335377698},
     {1.0, 0.8233023398606203, 1.0, 1.0, 0.3005212707706507, 0.4426224314089384},
     {1.0, 0.6950746910352855, 1.0, 1.0, 0.24236596939879862, 0.5050740484990563},
     {1.0, 0.5851746528236481, 1.0000000000000002, 1.0, 0.18848039994684762, 0.5705515201308402},
     {1.0, 0.4940981320503109, 1.0, 1.0, 0.14039752920655513, 0.639058517311182},
     {1.0, 0.4218169750660667, 0.9999999999999999, 1.0, 0.0995098307759089, 0.7108803915806089},
     {1.0, 0.36805038311511556, 0.9999999999999997, 1.0, 0.06713422278090464, 0.7866050410800731},
     {1.0, 0.3324525252995839, 0.9999999999999998, 1.0, 0.04459274451885918, 0.8671541699927742},
     {1.0, 0.31473414190031973, 1.0, 1.0, 0.03330861973033162, 0.9538323315084795}};

const uint32_t size_coef_bqfilter_2x_0 = sizeof(coef_bq_filter_2x_0) / sizeof(float);

// BQ-IIR 2x filter1  88.2k/96k to 176.4k/192k
const float coef_bq_filter_2x_1[5][6] =
    {{3.935060557949697e-05, 7.620427573587735e-05, 3.935060557949698e-05, 1.0, -0.8218933257725417, 0.17365817094497885},
     {1.0, 1.5218734086960366, 0.9999999999999999, 1.0, -0.8689368976525133, 0.2315521913233978},
     {1.0, 1.0090100171070195, 0.9999999999999998, 1.0, -0.9635361487535004, 0.3500179148817988},
     {1.0, 0.626528789932597, 0.9999999999999999, 1.0, -1.1092390567678763, 0.537535393815809},
     {1.0, 0.435219131085549, 1.0000000000000002, 1.0, -1.3176810631063525, 0.8149742025551101}};
;

const uint32_t size_coef_bqfilter_2x_1 = sizeof(coef_bq_filter_2x_1) / sizeof(float);

// BQ-IIR 2x filter2  176.4k/192k to 352.8k/384k
const float coef_bq_filter_2x_2[4][6] =
    {{7.331409658980419e-06, 1.3658751350342684e-05, 7.331409658980423e-06, 1.0, -1.2816769353089004, 0.41422377350564477},
     {1.0, 1.106773090818239, 1.0, 1.0, -1.3472004160176496, 0.48473097896656375},
     {1.0, 0.43313123434498524, 1.0, 1.0, -1.4801044276329434, 0.6285025578761835},
     {1.0, 0.10967205424069733, 1.0, 1.0, -1.6862717576220687, 0.8532309485716787}};

const uint32_t size_coef_bqfilter_2x_2 = sizeof(coef_bq_filter_2x_2) / sizeof(float);

// BQ-IIR 2x filter3  352.8k/384k to 705.6k/768k
const float coef_bq_filter_2x_3[4][6] =
    {{7.591714409361235e-07, 5.977812013727558e-07, 7.591714409361237e-07, 1.0, -0.8153896333098454, 0.0},
     {1.0, -0.34197532068910574, 0.9999999999999999, 1.0, -1.6595811713274504, 0.6941071340775591},
     {1.0, 1.0, 0.0, 1.0, -1.7438864507820504, 0.7798011281314047},
     {1.0, -0.7485893714724158, 1.0, 1.0, -1.8776984300256514, 0.9160592695961303}};

const uint32_t size_coef_bqfilter_2x_3 = sizeof(coef_bq_filter_2x_3) / sizeof(float);

// BQ-IIR 4x filter0  352.8k/384k to 1411.2k/1536k
const float coef_bq_filter_4x_0[3][6] =
    {{5.387756499116675e-07, 5.295041771639956e-07, 5.387756499116674e-07, 1.0, -1.8012094984621612, 0.8117345477897354},
     {1.0, -0.8717934351807886, 1.0, 1.0, -1.84871679612354, 0.8594503158324095},
     {1.0, -1.3043326329001699, 1.0000000000000002, 1.0, -1.9353227815837257, 0.94648768126873}};

const uint32_t size_coef_bq_filter_4x_0 = sizeof(coef_bq_filter_4x_0) / sizeof(float);

// FIR 4x filter0  44.1k/48k to 176.4k/192k
const float coef_fir_filter_4x_0[128] =
    {9.779537095829567e-06, 8.320024002841182e-05, 0.00040217349311986284, 0.0014243137991267708, 0.004070865861818099, 0.00986398461980456,
     0.02085291734821901, 0.03915202257796395, 0.06601040746689908, 0.10056479817041152, 0.13873184092374732, 0.17291818772104664,
     0.19317277684520287, 0.18995599525990925, 0.15792774936513193, 0.09936994736120536, 0.025508931915395047, -0.045544095302179684,
     -0.09423700641394653, -0.10674812266920028, -0.08098792308949547, -0.02849087109810905, 0.029291638014326722, 0.06930998575547588,
     0.07648861638958049, 0.05020224861739997, 0.004412770507736891, -0.03890174691867358, -0.06008915523896227, -0.050979900652444496,
     -0.01833801316887592, 0.020105220888309867, 0.04495692262055511, 0.04496348285088006, 0.02224256506071831, -0.009631126586262497,
     -0.033410089875505436, -0.03744933076935357, -0.021446749711295635, 0.004251205441306733, 0.025029221839562917, 0.030234888824940118,
     0.018624094233534803, -0.0017861008904920513, -0.018957654493522994, -0.023845653919500734, -0.015116038821859211, 0.0008852832793999376,
     0.014467509711818888, 0.018378128662548288, 0.011609924431546226, -0.0007368766655564362, -0.01104620093277607, -0.013801158252229835,
     -0.008458712763571956, 0.0008692541811737896, 0.008364326755702003, 0.010052999753013832, 0.005828843291198258, -0.00102856711990503,
     -0.006223610378577966, -0.007064624460542533, -0.003771657413121639, 0.001101041740831633, 0.0045097254689853445, 0.004760018494586116,
     0.0022632829780332353, -0.00105972220768595, -0.0031553747228454765, -0.003053110190744816, -0.0012324522092737088, 0.000925635370326995,
     0.0021142697070425636, 0.0018480474672419082, 0.0005832635641305202, -0.0007394508720353542, -0.0013453113533714272, -0.0010437763966967216,
     -0.0002141493246496537, 0.0005423412775214427, 0.0008054117713429177, 0.0005412980453474293, 3.223827326022429e-05, -0.00036521712273893353,
     -0.00044866245179232415, -0.0002511893880678232, 3.776070561590974e-05, 0.00022498140901482718, 0.0002291729404079561, 9.929568958337883e-05,
     -5.016956968926783e-05, -0.00012578297910886588, -0.00010505853245723002, -2.9432048219967047e-05, 3.945818893441664e-05, 6.295574629788832e-05,
     4.170161371979283e-05, 3.0034545870941026e-06, -2.4215587175218987e-05, -2.7565176916307177e-05, -1.3317920452036125e-05, 3.7055976115013487e-06,
     1.2194610190604457e-05, 1.0126886980387143e-05, 2.7287875640249225e-06, -3.4139481351183443e-06, -4.9966511091256924e-06, -2.852786667248453e-06,
     1.6023708301624479e-07, 1.7816967236892181e-06, 1.5704708652621246e-06, 4.551679252670012e-07, -4.4183391813282896e-07, -6.312848993006992e-07,
     -3.141678251288791e-07, 5.701531340332674e-08, 2.025774048517989e-07, 1.3294433658950897e-07, 6.339647315062052e-09, -5.6231117219454805e-08,
     -4.229538711543018e-08, -3.5267907086827414e-09, 1.5980020558677602e-08, 1.0035621672219318e-08, -2.803249436110445e-09, -3.555555566265609e-09,
     6.930163819276763e-10, 2.5055050379870897e-10};

const uint32_t size_coef_fir_filter_4x_0 = sizeof(coef_fir_filter_4x_0) / sizeof(float);

// FIR 2x filter1  88.2k/96k to 176.4k/192k
const float coef_fir_filter_2x_1[48] =
{3.3360564843645475e-05, 0.0003523537145792295, 0.0019479035135361207, 0.0073986748359036875, 0.021443941069533172, 0.049991614557148484, 
    0.09646656357981995, 0.1562901984488822, 0.21316488764332628, 0.24208720183672777, 0.2209550550852799, 0.14580390607737992,
    0.03911997641415518, -0.05755639560388964, -0.10533368603089906, -0.09083769412674561, -0.03401828440051029, 0.02551690798276319,
    0.054188092486256105, 0.043745943458961135, 0.011380752057310525, -0.01689897667620495, -0.025198038320748274, -0.015249553448507968,
    9.455934469275386e-05, 0.00907494568871351, 0.00855400259910473, 0.002925774169318973, -0.0018714865939526801, -0.0030958204634353023,
    -0.0017011106210167515, 3.776474106860893e-05, 0.0007699887185120032, 0.0005632025915198933, 0.00010618777396987576, -0.00013262201992526588,
    -0.00012270230405724014, -3.3577372621264804e-05, 1.638726703834121e-05, 1.7683314132634787e-05, 4.729124291082094e-06, -1.676408401526929e-06,
    -1.518209169374895e-06, -2.2939270286939258e-07, 1.3090689733882082e-07, 4.2726994320443245e-08, -3.5340924713787084e-09, -9.487966163104853e-10};;

const uint32_t size_coef_fir_filter_2x_1 = sizeof(coef_fir_filter_2x_1) / sizeof(float);

// FIR 2x filter2  176.4k/192k to 352.8k/384k
const float coef_fir_filter_2x_2[48] =
    {3.709785722749179e-05, 0.0003870655704767057, 0.0021165004026559055, 0.007957413759498986, 0.022836332911075785, 0.052711401885535795,
     0.10066975951123919, 0.1612913457220298, 0.21722465591574142, 0.24293559925691396, 0.21707007373971038, 0.13775159515431962,
     0.029864171484109126, -0.06398848555982675, -0.10622482367969052, -0.08657066144169431, -0.027853431513826864, 0.02964844858648731,
     0.054267300242787864, 0.040704386895273004, 0.007951319262839814, -0.01840793502548421, -0.024386646664519868, -0.013403764281419435,
     0.00138951273434572, 0.009150966328861511, 0.007831397429342066, 0.002222830489588985, -0.002081930453911382, -0.002892066029001908,
     -0.0014213984236683141, 0.00016071711720891515, 0.0007319925110537198, 0.0004791442447250391, 6.224213085782626e-05, -0.0001288094843742611,
     -0.00010363666390114375, -2.3207236303279864e-05, 1.617054560147816e-05, 1.4490979640598436e-05, 3.2303632696684967e-06, -1.5688680645295024e-06,
     -1.1644240182924044e-06, -1.3691560125759443e-07, 1.0285352714726494e-07, 2.897584527358658e-08, -2.69127915770613e-09, -6.009812970373258e-10};

const uint32_t size_coef_fir_filter_2x_2 = sizeof(coef_fir_filter_2x_2) / sizeof(float);